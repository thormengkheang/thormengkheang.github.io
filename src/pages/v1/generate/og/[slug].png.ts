import { Resvg, type ResvgRenderOptions } from "@resvg/resvg-js";
import type { APIRoute } from "astro";
import { getCollection } from "astro:content";
import satori from "satori";
import { html as toReactElement } from "satori-html";

const fontFile = await fetch(
  "https://og-playground.vercel.app/inter-latin-ext-700-normal.woff"
);
const fontData: ArrayBuffer = await fontFile.arrayBuffer();

const height = 630;
const width = 1200;

const posts = await getCollection("blog");

export function getStaticPaths() {
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { title: post.data.title, description: post.data.description },
  }));
}

export const GET: APIRoute = async ({ props }) => {
  const title = props.title.trim() ?? "Blogpost";
  const base64Img =
    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA8AAAADICAYAAAAnbYhrAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAACukSURBVHgB7d2Lddw217bhJxXEHXh3YHdg/BXYHZhvBXEq8KSCKBVIqSBOBZ5UYLsCUxVYqSD/7A/EIkUCnBlpDjzc11pYlEayNQeSwMbGQQIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAu7CcByLHO8UVT+h6a4ure9wAAAAAmhgAYa2a78ro5vmq+fqE2+H0KD4DrTvmnOX4VAAAAgKsiAMaaBMUg903z9Qtd1lYxEP67OZItBgAAAC6IABhL5gFupcMC3loxIPXA9L75vvv4Q+H/T/+nqR0u/ao5vta4rWIw/Knz9wAAAACcCQEwliYFvW8Vg96cWjH4/KYY8J4zG5uGWAfFwDgUfs+fw58iGAYAAAAA7BF25fOu/NiV/3rFH7tVDIwvPey5z/9+2JWbXfmu4XP14q+jEgAAAAAADQ8mP6oc9HqQGTRttisfduWLhq/BA+RbPW9RLgAAAADAjNmu/K5h4DuXoLfEduVO+cwwgTAAAAAArIgpBoK5IcOeRb328OZTqhRfF4EwAAAAAKyIqRz4Bi2bL6J1JwJhAAAAAFg0z+j6UOdc8Be0LiYCYQAAAOBZ2AYJU+SB7y8aDmu+25XftO5tgmxXNrvyvve4P/abAABrYGq32fN68mVzTN+n39nnIVPqXflX7RaB59wqEACA1QsaLgK1hqHOxzINM8L+vlUCACyF7co7xdFQf6m8fd65iy8y+bl5Ht45HbSsdTcArAgZYEyFaTi02Xudf92VrVASNBwG/UnxfasFAJgTUwx4Xyne3+3Af1erzd6mbO39Af/Og9ifm2MqpsOD269N+bs51gIAAHv5cOfulkb+9QfhGJWGmYGPAgBMmQeaHvB6R2ZuT/v+KB/PAvt2f5XaIdDnel7+/wfF+tj/5ucDn+Nt85rIEAMA0OOV6xc9rjy9kqXSfBpTflh0EABgKryO86ByLKD0x//SNIcbm2KAu9H+oNh/XonFGgEAK+cVuWcnCdTOwzTMBveHSQMALsfrvaBywJjm2HrAa5qfoDaoJxgGMGnMAcaledbXe7Wt85ivXuyZX1aZPK2N4vDylDmoFd/rOwGnZ72S5hWa2rmF+9TNMa1Ge692XmMq3CcwJ2FX3ioGfv1rwM/lPxXXbfiqZZ3bQfE1v1E+4N2qfe1c0wCAxepnfX3482vhnEzDYdFkg/Ecpnb4o59L/dEGrEYLtNne3Pl7o3WNePJ63l9z6V7h95EgALgQMsC4BNOwgvNM5Ea4lEqxA8Ka72uRDcZh0kI4b3RcsNndU1Q6bHVYa47d1WgPxWq0uLbSHvZuuyt/NMc1Zzz9fuLvTy4zXCvWS1tx/eLyrPP12KilVLf1v8aMEADj3LwxsFF7I/GG6f+aIy7LFD+L953H7hQbHLWAyK/VSocFvLXitXyvdghnOp6qUWBqh1F74/ll8/1rjT+3bkC8FY0UnE8p8PVzzoPeG3H+5QTFe837zM/uFIdIbwU8XepITeVl7zHpdCPicp2+/v2/ejyFJx0BLJDfYHyub3eYEys8T0Olx0PRvjePYb2C4giB3JDN/vYmUxp27EHwOx22RQsL8ODUTHEofv+8S4tZUd8dxpTfyq9bP/FeYkxaZM6vO6+nfIrdvi27rll+NM/xs9rpPF6X7evYxYmQAcY5BD2eZ1orZn23wlSYhtlgDyI8G0zP5DqY4udfKR8U+nnwaVf+0byGJAbFRsRblecVbsUCPHg6U+wwqnqPb9UO4cXTBOWzwrXa97cW1iyNBvLyRsfvh13rcSb2vvN4MjaKqTs8uvv1y+ZonWP358dIo6m6I6zS6CoAE+Q9Wd1eLs8C05s1XZWG2eAgLJVfi97T7L3OpSzpRss5B/z1eq/6nViAB8/n55MHvrnrJginZCpnhb1dEYS1SNNyvH1Zuo/nsqt+b//Q/NtrZ1ZN8Zz1+sifkycc/Dz2e8cxmeruIpApYwzgikyPG9V+kX4Q5sA0DIj85krHxXIE5YdqdoNe0/IFlYNhf+yjGCKNoRT45oY6B+HcvKGf67Tza7YSddXSpI7LQwJe//mt2iHEpnlKQ7j9NWx0XHBMUPxE3DjwXO/1+CL1njcT5sYrkO7n6BVLEOZqLNvrn/NG675Og4ZbhJEVRheB77SY4jXb/zxSEGTCXAXtX4ciBXobrWv7Ow9og2J97oGxt7EPDYo3YqvAohSwbESvAY7jF1R/yPONuNDmzEQ2eO5M+Ua7f8/QwaE0vC7XqPguFohbq0rD7BOB7zSYGB49dynjWRqZ1A3i0sKLeMxjtkrtIpD7gmKv41KW2IRshe8nmwko8wuvW/n4jSoIS5HLBlfClAWNZ3vpxNjP72t3yteLv4h6cQ2ChtfRF1G/TVWl8eHRJkxFd1RSKej1a80DuiDqrKfwOszf4zvtzxSnedKrDYj9RCu9SX6SVgIe84Zg9+bl54kJS2MaNixuxWc9NaX5cWSrns6UzzD5fY9rYJlMw+vIP+9KmANTfnh0qreCcA2m8aHN3SwvAe/ppfnUh2SJU4Y4aGWfhWl8GBiVPvyC6F9ALHS1fJXYN3hqSnMT/fvUe47TqJQfakmduAy5qTyMmpgv0/49hU04p6BYP+U+g349xTV2eUHx/rYvIE4dE6uaHmsqr5TplX4Q1iaI7XLWzDQcGspiZ5c3FvhuRGPinILyDQYC4XkqXUusY7EcQeML3b0TTuGQ+bzeZtyIduMUBe0PiFMitNKK6rtK+Tfli8gCrUGud/wv0UBYq0rDjjE/P0w4J1O+ceGfBUPHLsuUb1QTCM9HpfwCV6vKdKyIaTwrTGLneIfM500ZRBPmojtkemwOsX+2G63knmkqLw5SiRN8iUyPLwD29oXzG6TfHHP3AZxWEPN7p8pEIDw3QcPriWtpXYLKc4UJhscFMZ93bUyxbeeJr7Hsvl83Hjgv+nM3xZPbX3DuDTBhCfoLXTHcFX2mYQ+h3wcYVvZ8QQS+c2EiEJ66oPwCV3Torlfa/qwUzK2mUT/C1O49O7ZV0drfpzUJ2p8d9vOl0sLrv0osDrI0pmGFcCOgrFJ+OKEJx0hDynIVC1mJ6TOVA+EgXIMpvv/9BvtGNNbRMo0Hw6lO22jZ13LaQsevmVLAu5b3AvuZ2uzw2Lmy6IW0xrbhIBs0H/2s73dxg8PhNhoGwnSG7cfCVstiygfCXh8G4RJY4ApPZdo/5DNdz74uw1z3UDXF1+mvwV/L2GtNWV7/fa4flPi1cKfy6t/+eNpmaXFM4/OEMU2mfNaXGx2OZSILdqigfMchge8ymMqBcCWcQynwZUQKnipo/5DPdN9OQfEHTWeLH1MMTFJm11/HWLDbDXhZwApPFTR+3XzXQtuFpnwvQIr+TZiKfmOBrC9OwUTjPyc10HOVAhnCZTLRMXxuY4FvEHAa3RVy/dz674Di5+SX5ve9wb9RDCz9/wlNsabsC5hfdH7Xmn/r/0/V/L+/qw1yvx/4/P5rfv9GLGiL8zC1K4aPdbhUWlDHv2l8nvBix4TPQNCwEU7WF6dmYvX4tEdi7ubvN/4b0UhfA1P8rHMdw5VoeD4FgS+uLSg27u90eFB8rZKy1Ddq52XS5sMlmQ6bN1xpQXViJfYTngK/2d1q2AALAs7HVJ4b4jfCJa4VEJTfuzfd4NkqYp1M+Y5h//5WBMKHCMo3oAh8MQUeWAbFe7wHm36uHjL0+BQBrt9H/Drwe8lG8V5DoIspSiMq7nSFvaR/0uUFxQvyfe/xele2u/Jb8zVOy0+0X/S40f2wK38o3iSBS6kUszbWe9zPx0+78ndznJt0M3+j/JYQ/vr+VHxtWwHla2GreG+e43VwTn5deT0Weo9vFdsOWwHTZ4r1w4vO9+o9VlL3vn7oFWCugmKd6G0oy/y8VttG3GrGTPnhYN30N06jEtvUYHqCyj1//ljaS26qUyXS0GYPYPx6GhtyFkQPPMpKOyn4fXvt62aUhjl7uRUZXwBYmqByjNgdMVVp5m2rSuXK31/gVBvAUxc0fF+/iAYDpqfS+JyQ783PfQRD0HVueKbDto1gywg8lak8VSB1DJuWL+2JnWsXsEo6AKyHaXwRrVQ/bjTj+MZUrvzTXGET9gkanijeaPggYNq6c0JKPX/de4Kf52nbibSqpulpjWNT7GxLq2p2V9TcN3crraIZRMMcp1GpXOEvMRj266ZSuXMpvWauLwBYJ9P+fbrTyLuUMJmdSuuq/E+hUj7w3YhGA+bJA1K/ifnN7rv05EVBxspT/k+/zjzgzc31BU7JNN4hNOeKPl3fpbo+1V+MAgMA9AXt36fb685ZttNMsYIcq/wrrTcYLs2PIvDFEpniDW+jy6ys+b35O2mPRBriuKag8WA4zZ2fakCcAt5bjffep9EUAAAcwlQeQWj9X77GKtDPkSrPN8oHvF8VVwab/QphBwiKgW/oPf6guHrojVgREOvhHT3WOVrn8Z/3/Nv75lg3R7+PPIjV6DFtQe2q42MdM1+b8q051jr/uW1qpxS81P6pCbXa1d+3AgDgeUyxDvL23Lb/w7kFwF1B48tlpxfslWpqAMxd2JW3ys+D2qrdYoXAFwDWwxTrBy+lOrGv29HT7QQ6ZDsVa45p25aXzfG1DtvKJW159q051gIA4ELmHAB3pYVr3qrcE14rVvj/qM0UT11aEOiN2FcUAHAYU6wLw668UhuYXoPXU90M9FYEvACAK1pKANxlajOlrzXeE94fGpZ6xK8hDd305+wBb1D5uW9FthcAcLiUoU31Ysramp6/hkatx9nkWm2ncy0AACZkiQFwX+oFT/OkbM/vp95qP37rfO9qPb0yf9EpprYBYgc8rzRc7B8R9AIATu9Fr4ypm+Mhw6UBAJiUNQTAfabTDA2rC19LwwaE6Tgp6E7zl7cCAAAAADzLGgPgnP7QsFedx84p9Z57kHsv5kcBAAAAwNkQAO9najO43a9fdn6nn/HtDwu77zyW5kmlIwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICJ+kkA3ItdsV153Xz9sjn2S/LQlO7X983xa+cIAAAAYCIIgLFGtithV14pBrwp6D0HD4LrXfmn+XorAAAAAFdBAIw1sF15tytvFAPfQ4Ldh0JJuhnh9LXpMFvFgHgrAmIAAADgYgiAsVRhV94qBr5W+B0PaGvFzOy3ztf9YPcY1hQPiD2z/KbzWE6tGAT/KYJhAAAAAMCBbFc+7sqPXfkvU/zx2135oBicXvq5eTB+sytflH9+35vnFwQAAAAAQI9nWj2w/Kx8UOmPXyPg3cd2pdqVv1QOhv3n55qbDAAAAACYCQ8MS9neFPTOJXj051kpHwynrLAJAAAAALAqtiu/axj4+vcbTS/TeyxTDIY98O0HwwTCAAAAALACphgA5rK9PgR6iUOFS0O7CYQBAAAAYIE8sPWMby7wDVoH25U7EQgDAAAAz8I2SJgqD3x/0XAu73ZXftM6twwyxWHe73uP+2O+jVItAMAamfJ70tuef1dnjrUAAMBFVRrO8V1Txncf0zAjnFaNBgAskyne571j2EcA+ZZ6ufUiTlF+NP+/L874e/M3g9iZAACAk/IFrPpzXgl8y/z96jd+/HsTAGDOTDHY9eDTA9HS/vbXKP5cvG7eiKAYwAwxBBpTkLY0+tB57GFXflXMdGJcpfj+WeexO8Wh4rUAAFOX9rR/oxhU2p7frxXrya+7cq/yEOZa438zBa/WOVrz+KvmeMjuCl+b8rfiFKUHAQCArKBhFnMjepSfYiOGRQPAXATFzkvPpu7Ltt4o3s89GL1G/eh/Nyh2VPuw6C8azxKnDPHctyYEAOBkvAL3SrRfYVJZPo9p+L7eimHRADAFXsd50Nvv+O0GvH4P/6Dp14dejwfFQHcsiPfXeiumMwGYCIZA4xp8mJdXhqkX24dK+XDdG+FUKj0eFs17jEt7USglD2qHTda974E58/O+2pW3ygeB2135pzluNW9B7VDuXABfK77GP7XO3RwAACvjjQAPfPtZXxPOwTRcLZr3G6dkio3dtCqtZ64823PKBXv8//vc/N8bxUAiiGkSmL6guIhV7nrwc9qvG9NymeL1WsoO+7W99PcAALBiQY+HfHmD4J1wCUHD4XYfBRzHNL1Vaf28ToFxEEExri9lez8rP7x5o3UGfKbxYPizWLMCwIUwBBrnllvhebsr/xMrFF+Sfw6bXfml89hWfA4oM8VOqlfNcV9w6cOVa8WVYP/tfP/QKyX9FWnT9y8737/Wfv73t2qHlDKMGpfg56ffXz9oeK182pU/xJDfxBQ7rPz96l/TteL7xC4GOBdTvEbTsVv3vOz9bvdnuTrsvvezfqkFYHX6+9R67/cH4ZqC+EyQlxa08Qxv9xzJZbE8W3Oj66xK63/vnWKHzqGr0c5hQSHMU+rk7Y+ISNneS14bc2SKU3Vy9xyywniK1FlaKdZnt4r1xFi9ds7yo/n7fj6nEUteJ73T9VZ1B3Am3rPbbRD4hW/CFPjN1oOXfkPDhLVJQa83EEpDmn80P59yEHnMarTeICIYxnOVAl+CtqerlL9+vzc/MwGPmdpA14PL507N+d4rKXD9rDaI7pb/TlRSx3IKkD04DiI4PhuGQOPU0vZGofPYr2L14SkKerxFkg/XYaXodQiKK9JWGlawfh583ZW/FYciftU8Be1fjfZOcTXaWsBhSkOdt4r3z63wXKYYBLzRMOi9E8Oj1yp1dKZ7+qHZ01qxHvO67V7t1Jx0zA1tfspzyxVTO5UnfW86TnrufvxH7esBMBFBj3vEvot9/6Yulw3uBsVYjlLGqpvlrbTMHmcTC/DgecYyvkE4l0oMj14rv+a8EzMtvLgvg+q/4/VYGl5smq4UzKddFLwdlrLMh2aN/XfTnuFBZIuBq/AbVPfCvBMX45z4TbjfeVEJSxBUXpHWH/fPfk3Xqime27mGhp/3dAChi8B3GoKG2/p16yoTliAoXm+lzspu8Nddh2Jpjl3rovu+eB1Wiak+e3ngEgQ8jenxhcmiSvNlGjYwCAbmaSzb6w2L/vDNtTKNL8DzTlizSgS+U2MqX7PUV/Pj9VCl8fm7qbN2IzKdKTBOGeN9c55570Z03yS/eVDh41Dv9fji80DYhLmrRDZ4roJip2ZuRdob0XAfU2l8AR6sR9Aw40LgOz2VGB49R0H7s7z+s1RnEbSNM7XZ4kOCYv+d37W+0V8DuTfHbyi3In2OPL9g+kOeWThpWUzDbPBn0cExVUH5xgTZ3uOZ4rnfb0R4vfhRXANLFjS8jugAmb6g8vBortlpCBrfYm/p61BcWtoG6k77h0/7z9No4FW992mS+Z3yvQb+xlTihESU29s3CEtVaVhhfRSmolI58A3Cc5jy539qqJmwFN6+8c+0/zlvRNtnTkzl4dE+xJYRjpdzyBZ7Hl9sRF11CSnWS0On92WIN1rh51Ip3ihKWWET1uoXkRFco9xK0X4/YITIdZTm96YGuwmnVok5h0tUupZuROA7d5XKC915tsuEU0vzeb1tWAp606gkE64pdVDsC4j9c/SYsNKKPjNTudLv7/OKZTMNLxAWulof0/B+QABwOfsCXxrs5xeUbyxwHcxPpfwCVyYsiXfU3qm8IGAlPvPnMMX2YCmISoswVaKOmrJuhnhsyHR3uPQq+JuSO7m9MVwJS+affbfiIPOHjYb3ATpEzseUX9gqve80Ki4vKD/n8FY0pqcuaNie+Sw69Zeum53MNexTlov76biUOdw3n5cFrObN1M4hHvucV5MdNrEP21qUFrriZgZnGt4L6BA7rSDm906diUB4LoJY4AqRabxhT2b4MVOb5S0Nbfb3kp0GlssTX2OZ/nTdfNDCk2QmFgdZsqDhQleVgKFKw/uA3wRNeKogAt+5MREIT5WJBa5QFjQeDK9uyKfaNr5fN6X3pRvwmLAmaTTFncrnhz/u50/QglUqLw7CUNl5yWV9CWZwCK8E+/cBGv+HS/N7S52KQZgDE4HwVLDAFY4VtH/IZwr6gpbBr4WU3dsX8LJVEXKCxucOp2DYp1Qu8rwJKmctKmHqgoZZX+Z14hgmGv/H8oZHrpFOhmreTPlrgQUkz68U+NKZi2ME7V8QKJ1XnjioNP1rO83fTcHuvteW5niS5cWhTONz7VM9WGmB55RpfJ4wDbppIeuLUzOVA+EguKDywoIsbLUcpvy14J89e5Ke1ljgGwQ8nSler3faHzT+1/xOCoxTttg7Oy9xX7fm71WKnagp0P2h/c+7G/AyghPPZWq31h3bFqvSFWKOn3Q+pnjxvdHjF1bvynZXfmu+xvUEPc7OPSh+LjcCns8U7wHve49/3ZU/FBsTaxIU74e5AHereO1thSUy5a+FWvFzvxOeyq+lXzS8rrbimsJ5mGKAGHbllY4Pbmu17d+HTvn3gH/7c+dvvWiKdb4+lP89r4u/NcetaJPjvN41pR8XJn4e/ql4Ln7VAqTJ0p7ZICM0Dab8NhAm4PRM5VEh3Q6YJfL7X2nlxDTMmZ729TDl5ximEVImHMpExhfT4fdxb9xvFDNeh2SKL1G+N8/lVrEu8udoAq4raP8iWotafK7S+H7CDPs7r9wQMeb64lJMsXGQu+FdbRjMGYwFvd3Xyv1uvUzjHcMmlASxSjrmI8279cDT64WN4jX+uSkenPp94JAhyqnN9l1tYPu5+f9umv+7UhvkUsdgDrzzaKPDFtGaPVM+I5RWmCMjcnqVho0tVsPEtVQaDxDnNgcpKHYulV6TX3sbcb1hqNJ4pxDGO5UIfAFgGUwrWUTLVK78v4ghYacQlB/uHARcnyl2xOTuAd2ev0rTCYi7K2n6tVTquffHb8S1hsMEjXcMB61PUBwGl1slfa3vCQCsgaldRKsUDC9in+6g8oukojte0DDw9UZDJWCaPMAdC4bTOezn9UZxOMy5V9Y0tUPX/D50yJYYG3G/wtOZynOj/DGv7Jc8SsqU3xM7Xf8bMZICANYmrcReaiMetYr5OVeBfipTfJG/aJj9rRVXB0urhGEoKDYeQuexB8VVd2+ar4GpM8Vz+G1z3NfgTStaptU075vH687Pu+d+f8VMU7u6pnXKPrXiveifXfkkri+clteF75Wf+1QrnnN/a/71YVBcGTR1avVtxYrOAIAoLTrn9UYo/I63x7aKdeSdZiYoPySs2xMehNL8KHrLsRR+s/Nz/Jqra6beRe9I8hsv1xUuxTQ+Lyqdm/47c8gOm+JzvdX4/pC5LcMAAEhM+7PDg3pxihngHK8AU094yPy81jozw/6Beoas30gg44s18PPfmuNLtatepuOxUpa4borvyfi1KbW4ljANplgPlupDl3q+v6ndU/Fa569fi6+b8krxOVvhd7eKoynuxJ6kAIDjpfrG4yNTrPv+X/+X5hIAd5nGK/9uytuPtZYl7auchoZ2EfgCre4w5/6Q5/6Q6FrA/JhiPeDljcaH7adpAl58ikCtxx0+z30e3ekDqUMqdVKNPaet2qCXegsAcHZzDIC7TPt7wmu1FWyq/OdmLOh1WzE/CgDWrt/zfcxw6O4IiNzj1nms26FkOu5vbBXrYz/OsT4GAMzc3APgrrQ1yTuN94TXipXuFIaGlaTXkhYFsczvpGzvncheAQCGusOP33S+f8oUgWOkQDrVtenrWgAAXNmSAuA+r+SDYk/4vgq/PzQsVdS1zs/UDhPbNz/Kn6fPc/4ksr0AgKfpBsKmNqP7s4b1T/pZ3XmsO4XgvvN96lCuBQDARC05AO5LAXHKDh86NKxWO1fKS7eyTz/Pyc0/fKnHDQ7TuNSgSMPFtgIAAAAAPMmaAuC+/tAw0/W3j6jVBrwpIz214dkAAAAAMEtrDoBLrFdOsb1KUjfHFNimlTjZZgUAAAAAzowA+GkOWQGzO0y6+zUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALMFPAlBivWNJvSsPTQEAAAAwUQTAWLMXisHt61151fn6RVOeou6U+1352pRaAAAAAK6KABhrYrvyTjHYDdqf2T0lzw57IPx3c9wKAAAAwEURAGPJPIvrGd23u1JpPKubhjB7cHrffF03P6s1ztRmjV91/u6+v7dVDIi3IkMMAAAAnB0BMJbGg07P8r5XOQhNwed9czzXEOUUCHt5o3aIdc52V/4UwTAAAAAAYI+wK7/vyo9d+a9X/LHPu/JB5QD0UkwxQL/ble8aPlcvt83vAAAAAADwfzzD6kGtB7e5oPdGMTB+6oJWlxBUDob9sUqXnasMAAAAAJgQD2g/Kp/t9WA4aNpBb0lQDIZzr8uzwiYAAAAAwCqUAl//fqN5Br05/joq5bPCBMIAAAAAsGClwDdle5csKD/Em0AYAAAAABZkzYFvnykOj+4Hwr+LQBgAAAA4CNsgYap+0XBY83ZXfmuOa2WK78v7zmO14vtyJwDAGpge7zn/sjmmx1/0fjenbo4PvXLf/Kxuvv8qAABwNmFXvoiM7z6m4dBonzPM9kkAsBweyAbFHQ986ovXj7mFEs9d/O96neOjjryeufaWggDwZGSAMRVeyXvFWnUeq3fl1135JJRUisPErfPYnWJGuBYAYE68LvQA85Vi4HtooJmyt3Xn6+S+8G9edv5mKqbDF5RM2WEvfzfHBwEAgL18uHO3R3tpqzpfwkaPV4329/CDAABTFxQ7gLv38Fzx+7pnYW8U7+8eKJvOU1da87z8b2x25S8NR2flSsoSBwEAgAHTcBjvZ7Go01OZhgtlfRfvJwBMSRrWfKvycOZusJsC3anwrHSl+NzGgmJ/DX81v0uHNgBg9fpZXw/UgnAK3ljqZxI+CgBwTUExO1oKej3g3Wh+dWEK6D0g7ndq919fJTplAVwZc4BxaabY6x06j/2hWOkzd+i0Nnoc+Na78j+texVtnE+aP2idr182P7PO7+QyQd05i92VaLtzGmsxrx3z4+e7d/h+0PDc9/P606780xyXUgeaYh3v5a3y17y/Xp83fCcAABaMrO/lmYbZYM9AMBwNT3XtVWn97/mwyo1YjRbTFZTPhqahzf7ztdyHg2Kg26+LUjvA7yNcxwAuhgwwLsFE1vfaNiIbjKcxxWv3TXO0I/5t3Tv2V6dNupnh7mq0h2I1WkyBn7eVYtYz9H62VZvxXPO5GdS+R/0OAL9uvW2wFaM9cB2lUUo5tTBbBMA4N8/QePCbbii1CLyuxTTsiNgobpkEJGkblkMC3jQ02Ruu39QGounxUzwXa46vm+Or5rF9GaOt2oB4K+B8SsOc/Tr4U3G471boq3blvYadBWlouAfDXwU8j/XKz3o8ZUd6/rz0OnP08/hfPd6arBaBM7BoaV/f7lCnGzH0dgq8kdYfim7Cmvl16edFbsjmlFel9SC40mGr0Xrnjz9v7kE4FT+XfGRNfwoAW/kdxxTvP7kh0mnhLGBM6iStFNuePk0mdz5Npfhz+6x2Ok+l40dY4RnIAOMc/CbkF7U133uvl2d9PwlTYRpuObUR2eA1GRuu6VI2N2VQ55CJSY2glMEuZYnvFF8X9yQ8RSnju1XMWnJePV1QmxnuqtVmhWth7fzeHhRHBPnRDv+n2Wzsfe9nh7DO1y97j/nxmOHUfV+b5/at8zWjIYAJ80ZBv/fWhKnaaNgracJSpeHNfl2WeqU9mxq0jOyVKTamvUMut1BXWoAnCNivlPH16ykIp2SK9yK/RvvXLdfsuqSFFz2z69faIYsupnu7n0OV2lFL16jXTO2q6JViu8ufm7+W3Pk9VrqLQPr/xygT4MpMw0b1B2EOTOwbvHRB5f1H/bPfaB0NSm8E3an8PlSiAwhDBL7XVSnfafdZDI9eon7AOxYQ+jXpAWEKdE3zZGp3V/DX4q97bFpP/z3w39+IoBi4qKDhnNLXwtxsRDZ4aUrZXr9eU6Z3rSrFhlOuQXErzn1E/e37CHyvx9sVd8p3XvnnZMJcmdp1KMYyvB4Uzj3YPVaa1rPR4VnjlCn+INrjRd1eNBNwHBa6WhYT2eC5K2Wrug13rtGWKdZ/uUYFGab1ChqeEwS+02BiePQSBMU25FhA59fckqblnErKknuA64HuvmwxWeKMUoVvAspMjy84v7gY8rwcG5ENnpug2PhjRdqnCypnmCphDYKGoyb4/KerUr7x/0V8ZlOTFl7M1VP90UmVqLOO1Q+K982V9vvc71pxh9Gdyr0v9KQhpz8kzCsaE5bGNLw3+M2SSmlagsbnx/F5Hc+Urxv9+4/ifrdEptjmofNonoLKnVf+uZpwDd0t9koB2WcxVPdc0tZQd9qfJe5miFfF36TSkJLU+2nCmpX29sWybUQ2ZIoqlQPfIJxKpXwgTKN6GXJTBgh858sUP7tcWzZ1CuK8TPGaytVP6fry+2clrrFLSztBeNt9LCBOi4tVWlk9F5TvSUtZYRPWJuhxhfJDNLLXxDSszLgXXF5pfi8N9vOrVJ5zaMIc5Ra46u5hj3mrVF4E0K/bIJxKUKybcvfI9J4zl3d6Dg2IU6dv0EqYxhcHeSesAXv7IqnEIlnXQOA7HUH5RjWB8HwEscDVmpjK0/38MR/ZxvDb46TAqbS9XnpvN+K6mhNTO2S61JnRHU1hWoEgFgdZGxN7+2LINLwXcB84D1O+gZEWeCHwvZ6g/DZKtyIQnqqg/AJXdOavh3/Wpe3P/L5KMFxmOmw+70bcA5fCr4X0mZeC4XTdBC2cqbw4CPuwLUd/aJh/vlQK6PLzIZdFMeG5gpjfOxemfOfwrbgWpsLEAld4zFQeIp3aPH7OBK3Xoas2+3v4QVxLS5ey/ncqZ4fTdfNOCz4fTMyJWiLTsEJgb1+MqTS8D3APeJogAt+5MhEIT01p6sBG1GlomWIAV5oD2Q3ylpwIMMX6fN/evP4z5vPikOyw/6zSguvASmxIvgSVhlnfIGA/U6wQafwfb2x+r7+njLyYFxOB8LWVrikWuMI+pvHMcDcg3mi+QeAxe8Z2OwBMwJApXjdj59KiO5GC8nMrUg8Apsk0vNnfiZ49HM9E4/9QQfn5vQzNXAZT+VoIwjmUAl+v34KA4xwy5DMVzx57+3fT/JupNPL9NaS9YL2+8ee477X0A3zgWEH7h0ovct6waXzBLBOmoj/X179mQRA8l4nGf443RkpDhlLvKIHvspjy14J/3txrT4PAF5dgalfIHdsypt/u9fMwBcd+j/frPjTFdHyb+EXn34XmOVXN/3+rNsj9ccRzvG2eWxBwWt4BM7bNUjr/ghbEFF+0v7h+7xIZoevyE9Jvyv3ghMY3Tsk03hm2lvMtqLyQCI30dTCxk8KpEfjimtIw4o1i0HloUHxI8XP6u/Zna48t3WB30QsVYZJM4/OGU3y4qHOzEvsJT4GfUD7soH9DDALOx5Rv/KebXdDyBJX3SGSY83qZyjsp/C46hg9hyl9bBL64thQUe7t2o1i/+Xl56kB2LMBNw7E9AZUCXRMwLab98+3/0plGDv+kywuKw277QW+9K7/tyrb5Gqfn7/tGjxvd/p77TfJBwPmZ4j3go4Y3tFrx+v+zOc5Nmmv1Vvnstl9j2135Q/N8fTgtU/lauNN8r4NzCorvV+g9vlXbfgCmLA1fftEp0vAe4I//3Hx93/vZg9o2W935vhYwT2m+vbefgvLJge2u/N0cv2rGTOUJ0reiF/eUgoZDc7zHZZErsWE2gvJZ4e4wrUrT7rnubgOwb+VDsr0oqZQfPvldrJuRhjnn3h8yvgCwPEGH7TccNGNpo+3ci/THcr3jOEzQcGiBv6cMOceUmPYPg/HGbwqIr9VxY4rXziHbRhD04imCyp1CaSjYGqRhpLl7AtuDAcB6BI0votVtc822XggqV/7+4ioRDB8iaNhwYM4h5sC0fy+5blCcVtb0fxMUb37POcdN7ZYRfjO9bf7OvufyXfEGzaIiOAVTuWN4kYuEqA16S/Pm6VQCgHUz7U+YeL2ZOoxnFxCbykPCuj3hVISPBRH4YlmC4vnr5/WhWzp0z32/EX5p/n2/fFG7yuax/7f/m1vRKYfzCxofCubncqV5nodpW7BSh1fK9gYBANA6dJ/u75ppDGQaf3FrD4ZTA6LfWUDgiyXy3jy/4XmjOAWx/52x/FA7/Drtkcg1hWtJlX2pw8brydQxM8Web1N8bp7lLdXp/tr82g7iWgMAHCaN3st1qA7qw2usAv0cQfHFvVG+t3urhawQdoCg/GqzD4qrzLKyM9YkDX02tStrvmx+lr7v666k+a/aVTTTsRbXEKYraLw+dH7+fm3KP53vz31ep2vRr8tXale8LgW0/nw+qa2/ue4AAM/xuimpfnlkbgFw17umlCr/Wm1A/FXLWB4+KL5ez0T1GxK14rYZBL4AsC5eyQfF+sGP+zKn3UC4VuwAqvW4U6j7dZf1jqmzKW0D9kL7h2Onv5/q560AAMBRgvaPAZ/CKrLH6i4KMjb/KwgAgCgNBbvT+acJHDNn/oNYvRkAcGVzzgCXpJ7wtxpfEbY/NKzW9YdNm+Jz9yFj6XXkbBV7zu9EthcAsJ/XKdYcX6qdLpCOz5GyxXVT7tXWqbWopwAAE7LEALgvqB0aNhYQJ2lYmB//1eNhYqUhYYdKcxGtU16qbZjsC9YJegEA52B6PF+++3VX3RwfegUAgFlYQwDclyZFB7WZ1mPVvWNJtwFhOs52V74pTtxOQTgAAAAA4InWGADndIeGeVDcXczj3OqmfFO7cJcfCXgBAAAA4IQIgMd150elY1rxUjpspcsUyN5rOE+KoWMAAAAAAAAAAAAAAAAAAADAUf4/znZt3B9V67kAAAAASUVORK5CYII=";
  const html = toReactElement(`
  <div style="background-color: white; display: flex; flex-direction: column; height: 100%; padding: 3rem; width: 100%">
    <div style="display:flex; height: 100%; width: 100%; background-color: white; border-radius: 0.5rem; padding: 2rem; filter: drop-shadow(6px 6px 0 rgb(0 0 0 / 1));">
      <div style="display: flex; flex-direction: column; justify-content: space-between; width: 100%; filter: drop-shadow()">
        <div style="display: flex; flex-direction: column;">
          <div style="display: flex; height: 100%; flex-direction: column; gap: 0.75rem; justify-content: space-between;">
            <p style="font-size: 32px;">${title}</p>
            <img src="${base64Img}" width="80%" height="200px" />
            <p style="font-size: 24px;">Brought to you by KheangCodes</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  `);

  const svg = await satori(html, {
    fonts: [
      {
        name: "Inter Latin",
        data: fontData,
        style: "normal",
      },
    ],
    height,
    width,
  });

  const opts: ResvgRenderOptions = {
    fitTo: {
      mode: "width", // If you need to change the size
      value: width,
    },
  };
  const resvg = new Resvg(svg, opts);
  const pngData = resvg.render();
  const pngBuffer = pngData.asPng();

  return new Response(pngBuffer, {
    headers: {
      "content-type": "image/png",
    },
  });
};
